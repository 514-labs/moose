# Consumption APIs

Consumption APIs are HTTP endpoints that retrieve and process data from your database based on client query parameters. As a developer, you create functions to handle these parameters and fetch or process data. When saved in the /apis folder of your project, Moose auto-generates and manages the /consumption HTTP endpoints, which run on the same web server as the /ingest APIs for your projectâ€™s data models. Upon client requests, Moose executes the function and sends the return values back to the client

## Initialize Your API Endpoint

To create a new API endpoint, run this command in your CLI

```bash copy
moose api init <your-endpoint-name>
```

This command creates a new file named `<your-endpoint-name>.ts` in the `/apis` folder of your Moose project

## API Route Handler

Open the newly created file and define your API using an asynchronous function.

Example structure:

```ts filename="api/dailyActiveUsers.ts" copy
interface QueryParams {
  limit: string;
  minDailyActiveUsers: string;
}

export default async function handle(
  { limit = "10", minDailyActiveUsers = "0" }: QueryParams,
  { client, sql },
) {
  return client.query(
    sql`SELECT
      date,
      dailyActiveUsers
    FROM DailyActiveUsers
    WHERE dailyActiveUsers >= ${parseInt(minDailyActiveUsers)}
    LIMIT ${parseInt(limit)}`,
  );
}
```

Your function handler should be an asynchronous function and the default export of the file.

Additionally, the function takes two arguments:

- An object containing the query parameters (with default values if needed).
- An object containing helper functions, including the database client (`client`) and a SQL tag function (`sql`).

## Query Parameters

Define your parameter names and data types in the QueryParams interface. Inject them into your SQL query template string.

You can either parse your parameters within the template string directly or separately in your function before injecting them into the template string.

## Test Your API

Test your API by making an HTTP GET request to your local Moose developer server at:
`https://localhost:4000/consumption/<your-endpoint-name>`

---

For more information refer to the [Consumption APIs](/building/consumption-apis/creating-endpoints) page.
