---
title: Runtime
description: The execution environment that runs your Moose application and manages all infrastructure
---

import { TypeScript, Python, LanguageSwitcher, CTACards, CTACard, Callout } from "@/components";
import { Cards, Card } from "nextra/components";

# Runtime

<LanguageSwitcher />

The Moose Runtime is the execution environment that runs your analytical backend application. When you run `moose dev` or `moose prod`, the runtime starts up and automatically manages all the infrastructure your application needs - databases, streaming, API servers, and workflows. 


It also manages the processes (Node.js, Python) to run your server functions: streaming functions, query API route handlers, and workflow tasks.

## Core Components

**Infrastructure Map (Redis)**
- Stores the state of all your application components (tables, streams, views, APIs, functions, workflows)
- Used as the source of truth when diffing code changes against the state of the infrastructure
- Provides versioning and rollback capabilities

**Web Server**
- Main API server for all routes defined in your application code (port 4000)
- Management server for administrative operations (port 5001)

**<Python inline>Python</Python><TypeScript inline>Node.js</TypeScript> Runtime** for all server functions defined in your application code, including:
- Streaming functions
- API route handlers
- Workflow tasks

**Kafka to ClickHouse Data Sync (Rust)**
- Rust-process that syncs data between streaming topics and OLAP tables

## Managed Infrastructure

The runtime automatically provisions and manages these components based on what your application uses:

- **ClickHouse (`olap`)**: Columnar database for fast analytical queries
- **Redpanda (`streaming`)**: Kafka-compatible streaming platform for real-time data
- **Temporal (`workflows`)**: Workflow engine for data orchestration
- **Redis**: State coordination and caching (always required)

### Configuration

You can configure which features you want to use in your project configuration. Only the features you enable will be started by the runtime:

```toml copy
[features]
olap = true 
streaming = true
workflows = true
```

## Development vs Production

The Moose runtime behaves differently in development and production environments:

### Development (`moose dev`)

**What it does:**
- Runs everything locally using Docker containers, no configuration needed
- Automatically starts ClickHouse, Redpanda, Temporal, and Redis
- Watches your code for changes and hot-reloads on save
- Handles all container setup and networking
- Designed for learning and prototyping quickly

**How it works:**
1. Reads your `moose.config.toml` to determine which services to start
2. Spins up Docker containers for each enabled feature
3. Monitors your `app/` directory for file changes
4. Automatically rebuilds and redeploys when you save files

### Production (`moose prod`)

Unlike `moose dev`, `moose prod` requires that you have the underlying infrastructure services (Redis, ClickHouse, Redpanda, Temporal) already running somewhere else.

**What it does:**
- Connects to your existing external infrastructure
- Compares your code with running services
- Applies schema changes on startup
- No hot-reloading or file watching

**How it works:**
1. Connects to external services using your environment variables
2. Compares your current code with the running infrastructure
3. Applies any necessary schema changes (new tables, columns, etc.)
4. Starts your application with production settings


## Quick Start

<TypeScript>
```bash
# Start development environment (manages all infrastructure locally)
moose dev

# Build for production deployment
moose build

# Run in production mode (connects to external infrastructure)
moose prod
```
</TypeScript>

<Python>
```bash
# Start development environment (manages all infrastructure locally)
moose dev

# Build for production deployment
moose build

# Run in production mode (connects to external infrastructure)
moose prod
```
</Python>

## Common Workflows

**Starting a new project:**
1. Define your data models
2. Run `moose dev` - runtime creates tables and APIs automatically
3. Send data to your endpoints and query immediately

**Making changes:**
1. Update your code (add fields, create new models, etc.)
2. Runtime detects changes and updates infrastructure automatically
3. No restarts or manual migrations needed

**Going to production:**
1. Run `moose build` to create production artifacts
2. Deploy infrastructure externally (or use `--start-include-dependencies`)
3. Run `moose prod` to connect runtime to production infrastructure

<Callout type="info">
For detailed production deployment instructions including containerization, Kubernetes deployment, cloud configuration, and monitoring setup, see the [Self-Hosting Deployment Guide](/moose/deploying/self-hosting).
</Callout>
