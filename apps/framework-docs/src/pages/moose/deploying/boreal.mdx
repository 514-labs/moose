---
title: Boreal Cloud Deployment
description: Deploying Moose applications to Boreal cloud platform
---

import { Callout } from "@/components";

# Boreal Cloud Deployment

[Boreal](https://fiveonefour.com/boreal) is the managed cloud platform for deploying Moose applications. It provides a fully managed infrastructure that automatically handles scaling, monitoring, and maintenance of your Moose applications.

## Version Detection

When deploying to Boreal, the platform automatically detects the appropriate Moose CLI version to use based on your project configuration. This ensures compatibility between your local development environment and the deployed application.

<Callout type="info">
Boreal automatically manages version compatibility between the Moose CLI and your project's library dependencies, eliminating version mismatch issues.
</Callout>

### TypeScript Projects

For TypeScript projects, Boreal determines the Moose version using the following priority order:

1. **pnpm-lock.yaml** (preferred)
2. **package-lock.json** 
3. **package.json** (fallback)

The version detection process looks for the `@514labs/moose-lib` package version in these files. Here's how the logic works:

```js
async function getMooseVersionForTypescript() {
  // Try pnpm-lock.yaml first
  const pnpmVersion = await getMooseVersionFromPnpm(repoRootDir, mooseProjectDirectory);
  if (pnpmVersion) {
    return pnpmVersion;
  }

  // Fall back to package-lock.json or package.json
  let packageFile = `${mooseProjectDirectory}/package-lock.json`;
  if (!fs.existsSync(packageFile)) {
    console.log(
      `Could not find package-lock.json, package.json will be used to determine the moose-cli version requirement`
    );
    packageFile = `${mooseProjectDirectory}/package.json`;
  }

  let mooseVerRequirement;
  const packageJson = JSON.parse(fs.readFileSync(packageFile, "utf-8"));
  if (packageFile.endsWith("package-lock.json")) {
    // For package-lock.json, version is under packages['node_modules/@514labs/moose-cli']
    mooseVerRequirement = packageJson.packages[""].dependencies[MOOSE_LIB_TS_PACKAGE];
  } else {
    // For package.json, version is under dependencies directly
    mooseVerRequirement = packageJson.dependencies[MOOSE_LIB_TS_PACKAGE];
  }
  if (mooseVerRequirement === "latest") {
    mooseVerRequirement = "*";
  }

  return mooseVerRequirement;
}
```

**Key Points:**
- Boreal looks for the `@514labs/moose-lib` package version
- If "latest" is specified, it's treated as "*" (any version)
- Lock files take precedence over package.json for more precise versioning

### Python Projects

For Python projects, Boreal searches for version information in:

1. **setup.py** (preferred)
2. **requirements.txt** (fallback)

The search includes subdirectories if files aren't found in the project root. Here's how the logic works:

```js
async function getMooseVersionForPython() {
  let content;
  let setupPyPath = `${mooseProjectDirectory}/setup.py`;
  let requirementsTxtPath = `${mooseProjectDirectory}/requirements.txt`;

  // Try to find setup.py or requirements.txt, including in subdirectories
  if (!fs.existsSync(setupPyPath)) {
    // Search for setup.py in subdirectories
    const files = fs.readdirSync(mooseProjectDirectory, { recursive: true });
    const setupPyFile = files.find((file) => file.endsWith("setup.py"));
    if (setupPyFile) {
      setupPyPath = `${mooseProjectDirectory}/${setupPyFile}`;
    }
  }

  if (!fs.existsSync(requirementsTxtPath)) {
    // Search for requirements.txt in subdirectories
    const files = fs.readdirSync(mooseProjectDirectory, { recursive: true });
    const requirementsTxtFile = files.find((file) => file.endsWith("requirements.txt"));
    if (requirementsTxtFile) {
      requirementsTxtPath = `${mooseProjectDirectory}/${requirementsTxtFile}`;
    }
  }

  let mooseVerRequirement = "*";
  // Try setup.py first
  if (fs.existsSync(setupPyPath)) {
    console.log(`Attempting to get moose-cli version requirement for Python from setup.py`);
    content = fs.readFileSync(setupPyPath, "utf8");
    const lines = content.split("\n");
    const mooseLibLine = lines.find((line) => line.includes(`"${MOOSE_LIB_PY_PACKAGE}`));
    const match = mooseLibLine?.match(/==([0-9.]+)/)?.[1];
    if (match) mooseVerRequirement = match;
  }

  // If version is still *, try requirements.txt
  if (mooseVerRequirement === "*" && fs.existsSync(requirementsTxtPath)) {
    console.log(`Attempting to get moose-cli version requirement for Python from requirements.txt`);
    content = fs.readFileSync(requirementsTxtPath, "utf8");
    const lines = content.split("\n");
    const mooseLibLine = lines.find((line) => line.includes(MOOSE_LIB_PY_PACKAGE));
    const match = mooseLibLine?.match(/==([0-9.]+)/)?.[1];
    if (match) mooseVerRequirement = match;
  }

  console.log(`moose-cli version requirement for Python: ${mooseVerRequirement}`);

  return mooseVerRequirement;
}
```

**Key Points:**
- Boreal looks for the `moose_lib` package version
- Searches both root directory and subdirectories
- Uses exact version matching with `==` syntax
- Defaults to "*" (any version) if no specific version is found

## Deployment Process

<Callout type="info">
The version detection happens automatically during the deployment process. You don't need to manually specify the Moose CLI version.
</Callout>

1. **Push to Repository**: Commit your changes to your connected Git repository
2. **Version Detection**: Boreal automatically detects the required Moose version from your project files
3. **Environment Setup**: The appropriate Moose CLI version is installed in the deployment environment
4. **Build & Deploy**: Your application is built and deployed using the detected version

## Best Practices

### For TypeScript Projects

- **Use exact versions** in your package.json dependencies:
  ```json
  {
    "dependencies": {
      "@514labs/moose-lib": "1.2.3"
    }
  }
  ```

- **Commit lock files** (pnpm-lock.yaml or package-lock.json) to ensure reproducible builds

### For Python Projects

- **Specify exact versions** in requirements.txt or setup.py:
  ```
  # requirements.txt
  moose_lib==1.2.3
  ```

  ```python
  # setup.py
  install_requires=[
      "moose_lib==1.2.3",
  ]
  ```

- **Include version constraints** to prevent unexpected updates in production

## Troubleshooting

If you encounter version compatibility issues, check your dependency files to ensure they specify the correct version, update your lock files locally, and use exact versions rather than "latest" in production.

Monitor your Boreal deployment logs to see which version was detected and used.