{"version":3,"file":"views.js","sourceRoot":"","sources":["../../app/views/views.ts"],"names":[],"mappings":";;;;;;AAAA,gDAAuC;AAEvC,gDAA2D;AAC3D,2CAA+C;AAS/C,IAAM,MAAM,GAAG,oBAAW,CAAC,KAAM,CAAC,OAAO,CAAC;AAC1C,4CAA4C;AAC5C,IAAM,KAAK,GAAG,mCACK,MAAM,CAAC,YAAY,CAAC,IAAI,yCAC/B,MAAM,CAAC,UAAU,CAAC,IAAI,0CACpB,MAAM,CAAC,OAAO,CAAC,IAAI,yCACvB,MAAM,CAAC,UAAU,CAAC,IAAI,4CACtB,MAAM,CAAC,UAAU,CAAC,IAAI,wCACvB,oBAAW,CAAC,KAAM,CAAC,IAAI,uCACN,MAAM,CAAC,YAAY,CAAC,IAAI,UAC/C,CAAC;AACJ,8BAA8B;AAC9B,4HAA4H;AAC/G,QAAA,eAAe,GAAG,IAAI,4BAAgB,CAAgB;IAC/D,SAAS,EAAE,eAAe;IAC1B,oBAAoB,EAAE,kBAAkB;IACxC,aAAa,EAAE,CAAC,YAAY,CAAC;IAC7B,eAAe,EAAE,KAAK;CACzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAEK,IAAI,CAAC,KAAK,CAAC,6sBAA6sB,CAAQ,CAAC,CAAC","sourcesContent":["import ____moose____typia from \"typia\";\nimport typia from \"typia\";\nimport { MaterializedView, sql } from \"@514labs/moose-lib\";\nimport { BarPipeline } from \"../ingest/models\";\n//Define the data model for the materialized view\ninterface BarAggregated {\n    dayOfMonth: number & typia.tags.Type<\"int64\">;\n    totalRows: number & typia.tags.Type<\"int64\">;\n    rowsWithText: number & typia.tags.Type<\"int64\">;\n    totalTextLength: number & typia.tags.Type<\"int64\">;\n    maxTextLength: number & typia.tags.Type<\"int64\">;\n}\nconst BTCols = BarPipeline.table!.columns;\n//Define the query for the materialized view\nconst query = `SELECT\n    toDayOfMonth(${BTCols.utcTimestamp.name}) as dayOfMonth,\n    count(${BTCols.primaryKey.name}) as totalRows,\n    countIf(${BTCols.hasText.name}) as rowsWithText,\n    sum(${BTCols.textLength.name}) as totalTextLength,\n    max(${BTCols.textLength.name}) as maxTextLength\n  FROM ${BarPipeline.table!.name}\n  GROUP BY toDayOfMonth(${BTCols.utcTimestamp.name})\n  `;\n//Create the materialized view\n//Automatically generates the materialized view in the underlying OLAP database as defined by the query and data model above\nexport const BarAggregatedMV = new MaterializedView<BarAggregated>({\n    tableName: \"BarAggregated\",\n    materializedViewName: \"BarAggregated_MV\",\n    orderByFields: [\"dayOfMonth\"],\n    selectStatement: query,\n}, ____moose____typia.json.schemas<[\n    BarAggregated\n]>(), JSON.parse(\"[{\\\"name\\\":\\\"dayOfMonth\\\",\\\"data_type\\\":\\\"Int\\\",\\\"primary_key\\\":false,\\\"required\\\":true,\\\"unique\\\":false,\\\"default\\\":null,\\\"annotations\\\":[]},{\\\"name\\\":\\\"totalRows\\\",\\\"data_type\\\":\\\"Int\\\",\\\"primary_key\\\":false,\\\"required\\\":true,\\\"unique\\\":false,\\\"default\\\":null,\\\"annotations\\\":[]},{\\\"name\\\":\\\"rowsWithText\\\",\\\"data_type\\\":\\\"Int\\\",\\\"primary_key\\\":false,\\\"required\\\":true,\\\"unique\\\":false,\\\"default\\\":null,\\\"annotations\\\":[]},{\\\"name\\\":\\\"totalTextLength\\\",\\\"data_type\\\":\\\"Int\\\",\\\"primary_key\\\":false,\\\"required\\\":true,\\\"unique\\\":false,\\\"default\\\":null,\\\"annotations\\\":[]},{\\\"name\\\":\\\"maxTextLength\\\",\\\"data_type\\\":\\\"Int\\\",\\\"primary_key\\\":false,\\\"required\\\":true,\\\"unique\\\":false,\\\"default\\\":null,\\\"annotations\\\":[]}]\") as any);\n"]}