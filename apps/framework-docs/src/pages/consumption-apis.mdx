import Callout from "../components/callout";

# Introduction to Consumption APIs

Moose **Consumption APIs** offer a powerful and flexible way to create custom API endpoints, allowing your applications to access and retrieve data from your OLAP database. These APIs act as the final layer in your Moose application, dynamically generating and executing SQL queries based on parameters received from incoming requests from your data consumers.

## Core Concepts

### HTTP Server and Request Handling

At the heart of Moose's Consumption APIs is an HTTP server that manages incoming `GET` requests. When a request is made to the `/consumption/<endpoint-name>` path, Moose automatically routes it to the corresponding handler file in your project's `/apis` directory.

### API Definition and File-Based Routing

Consumption APIs are defined as individual files within the `/apis` folder of your Moose application. These files, written in TypeScript (`.ts`) or Python (`.py`), are automatically mapped to API endpoints based on their filenames. For instance, a file named `mostUsedLanguages.ts` would correspond to the `/consumption/mostUsedLanguages` endpoint.

### Route Handler Functions

Each API file contains a route handler function that processes requests to its corresponding endpoint. This function is responsible for:

1. Parsing query parameters from the incoming request
2. Dynamically constructing SQL queries based on these parameters
3. Executing the queries against your database
4. Processing and formatting the results before sending the response

#### Language-Specific Conventions

The definition of route handler functions follows language-specific conventions:

- **TypeScript**: Export the function as the default export of the file.
- **Python**: Define a single function named `run()` in the file.

### Query Parameters and Dynamic Data Retrieval

Query parameters play a crucial role in Consumption APIs, allowing for dynamic and flexible data retrieval. When defining your route handler function, you can specify the query parameters it accepts. These parameters are then passed to the function as arguments, mapped directly from the URL query parameters of the incoming HTTP `GET` request.

<Callout
  type="info"
  title="Giving you the flexibility to customize your data endpoints"
>
  This enables you to create highly customizable data endpoints that can adapt
  to various client requirements without the need for multiple, static API
  endpoints.
</Callout>
