# Streaming Functions

        Streaming Functions let you create custom functions to process incoming records of data in stream. They are suited for tasks like transforming, augmenting, or reacting to data before it reaches the database. These functions use a source Data Model as input and a destination Data Model as output, instructing Moose on which streaming topics to listen to and where to publish the results. Moose will automatically run your function on new records for the specified source Data Model. You can chain multiple Streaming Functions for complex, multi-step data processing workflows.

        ## Create a Streaming Function in CLI

        Initiate your streaming function setup in Moose with the `moose function init` CLI command.

        ```txt filename="Terminal" copy
        moose function init --source <YourSourceDataModel> --destination <YourDestinationDataModel>
        ```

        By way of example:

        ```txt filename="Terminal" copy
        moose function init --source UserActivity --destination ParsedActivity
        ```

        Represents a streaming function from a source data model `UserActivity` and a destination
        data model `ParsedActivity`, which themselves were defined in
        `/datamodels/models.ts`:

        ```ts filename="models.ts"
        import { Key } from "@514labs/moose-lib";

        export interface UserActivity {
            ...
        }

        export interface ParsedActivity {
            ...
        }
        ```

        Ensure your development server is running to keep Moose updated with your data
        model definitions. When you run this command, you will create the streaming function file
        and file structure described below.


        ## Transformation Logic

        Now that you have your streaming function file, you have to define the transformations within it.

        Here's an example streaming function that converts timestamps to UTC:

        ```ts filename="UserActivity__ParsedActivity.ts" copy {3-4,8}
        // Example streaming function: Converts local timestamps in UserEvent data to UTC.
        // Imports: Source (UserActivity) and Destination (ParsedActivity) data models.
        import { UserActivity } from "/path/to/UserActivity";
        import { ParsedActivity } from "/path/to/ParsedActivity";

        // The 'convertUtc' function transforms UserActivity data to ParsedActivity format.
        export default function convertUtc(
          source: UserActivity,
        ): ParsedActivity[] | ParsedActivity | null {
          // Convert local timestamp to UTC and return new ParsedActivity object.
          return {
            id: source.id, // Retain original event ID.
            userId: "puid" + source.userId, // Example: Prefix user ID.
            activity: source.activity, // Copy activity unchanged.
            timestamp: new Date(source.timestamp), // Convert timestamp to UTC.
          };
        }
        ```

        Adjust function specifics according to your data transformation needs. The
        function's return type can be null (meaning no transformation will take place),
        a single object, or an array of objects.

        To test and confirm your streaming function's logic:

    1. Ingest test data into the source data model to trigger the function.
    2. After the streaming function processes the data, check the destination table in the database to see if the data has been
    transformed correctly.

    ---

    For more information refer to the [Streaming Functions](/building/streaming-functions/setup) page.
